<app-back-header title="Reparto de tareas manual"></app-back-header>

<ion-content>
  <ion-list class="ion-no-padding ion-padding-horizontal">
    <ion-item class="explanation-item">
      <ion-icon
        slot="start"
        color="secondary"
        name="information-circle-outline"
        style="margin-inline-end: 15px"
      ></ion-icon>
      <ion-label>Crea tareas para añadirlas a la lista</ion-label>
    </ion-item>
    <ion-item class="explanation-item">
      <ion-icon
        slot="start"
        color="secondary"
        name="information-circle-outline"
        style="margin-inline-end: 15px"
      ></ion-icon>
      <ion-label>Asígnad las tareas entre los miembros del equipo</ion-label>
    </ion-item>
    <ion-item class="explanation-item">
      <ion-icon
        slot="start"
        color="secondary"
        name="information-circle-outline"
        style="margin-inline-end: 15px"
      ></ion-icon>
      <ion-label>Solamente un administrador podrá terminar el reparto</ion-label>
    </ion-item>
  </ion-list>

  <ion-list lines="none">
    <ion-list-header class="ion-padding-horizontal">
      <ion-label><h3 class="list-title">Lista de tareas</h3></ion-label>
      <ion-button
        [routerLink]="['/create-task', idTeam, idTaskList]"
        color="primary"
        fill="solid"
        shape="round"
      >
        Crear tarea
      </ion-button>
    </ion-list-header>

    <app-task-slide [tasks$]="tasksUnassigned$" [withoutUsers]="true"></app-task-slide>
  </ion-list>

  <ng-container *ngIf="team$ | async as team">
    <ion-list lines="none" *ngFor="let user of team.team?.userMembers | objValues">
      <ion-list-header class="ion-padding-horizontal">
        <ion-label><h3 class="list-title">Lista de {{ user.name }}</h3></ion-label>
      </ion-list-header>

      <app-task-slide
        [tasks$]="team[user.id]"
        [withoutUsers]="false"
        [noTasksMessage]="user.name + ' no tiene ninguna tarea asignada'"
      ></app-task-slide>
    </ion-list>
  </ng-container>

  <ng-template #loading>
    <ion-spinner class="loading-content" name="circles" color="primary"></ion-spinner>
  </ng-template>

  <ion-button class="ion-margin" expand="block" fill="solid" shape="round">
    Terminar reparto
  </ion-button>
</ion-content>
